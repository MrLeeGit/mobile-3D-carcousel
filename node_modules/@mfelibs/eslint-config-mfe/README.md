# ESLint 配置

## 安装
```bash
cnpm install @mfelibs/eslint-config-mfe --save-dev
```

### 配置
在项目根目录下建立 `.eslintrc.yml` 文件，写入配置：

```javascript
extends: '@mfelibs/eslint-config-mfe'
```

#### 严格模式
默认情况下，eslint-config-mfe 只校验语法错误，如需校验编码风格，可启用严格模式：

```javascript
extends: '@mfelibs/eslint-config-mfe/strict'
```

## 与 webpack 集成
安装 `eslint`, `eslint-loader`

```bash
cnpm install eslint eslint-loader --save-dev
```

在 `webpack.config.js` 中写入规则

```javascript
rules: [
  {
    enforce: 'pre',
    test: /\.js$/,
    exclude: /node_modules/,
    loader: "eslint-loader",
  },
  ...
]
```

**注意：添加 `enforce: 'pre'` 属性以确保在其他加载器（如 `babel-loader`）执行之前进行校验**

## 与 Sublime 集成
可以通过安装 [SublimeLinter](http://www.sublimelinter.com/en/latest/) 插件与 Sublime 编辑器集成，在编辑文件时进行实时校验，与传统命令行提示相比，这种方式更加直观。

### 安装 Sublime 插件

在 `Package Control` 中分别安装 `SublimeLinter` 与 `SublimeLinter-contrib-eslint` 插件

![Package Control](http://wap_front.dev.sina.cn/wensen/readme-img/eslint-config-mfe/package_control.png)

#### 新建自定义配置

打开 【选项 - Package Settings - SublimeLinter -Settings - Default】

![Settings](http://wap_front.dev.sina.cn/wensen/readme-img/eslint-config-mfe/sublime_linter_setting.png)

拷贝其内容至用户自定义配置（Settings - User）文件中

#### 编辑自定义配置
为了不影响编辑器的性能，我们将 SublimeLinter 默认配置改为在文件保存时执行 eslint 验证，并且忽略 `node_modules` 与 `vendor` 文件夹下的文件。

将 `lint_mode` 属性值设为 `save only`，在 `linters` 属性中加入 `eslint` 配置：
```json
"user": {
    "debug": false,
    "delay": 0.15,
    "error_color": "D02000",
    "gutter_theme": "Packages/SublimeLinter/gutter-themes/Default/Default.gutter-theme",
    "gutter_theme_excludes": [],
    "lint_mode": "save only",
    "linters": {
        "eslint": {
            "@disable": false,
            "args": [],
            "excludes": [
                "**/node_modules/**",
                "**/vendor/**"
            ]
        }
    },
    ...
}
```

设置完毕后，编辑项目下的 js 文件，即可在保存时看到 eslint 的校验反馈

![配置完成](http://wap_front.dev.sina.cn/wensen/readme-img/eslint-config-mfe/config_done.png)


##  *与 git 集成
另一种使用方式是与 git 集成，通过 `pre-commit` 钩子在每次提交前检测，如果检测失败则禁止提交。

```bash
npm i pre-commit -D
```

在 `package.json` 中配置 `pre-commit` 属性：
```javascript
"pre-commit": [
  "eslint"
]
```

完成之后，在每次提交之前，都会运行 eslint 命令进行检测，如果检测到有违反代码规则的情况，则会返回 `1`，导致 git commit 失败。
