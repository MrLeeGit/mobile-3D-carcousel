import { getUrlParam, load } from './utils.js'

const erudaUrl = '//mjs.sinaimg.cn/wap/online/others/eruda/eruda.min.js'
const mdebugUrl =
  '//mjs.sinaimg.cn/wap/online/public/mdebug/201706161130/js/index.min.js'

const fireMap = {
  _devtools: devtools,
  _mlog: mlog
}

function devtools(debugMode) {
  if (debugMode) {
    load(erudaUrl, () => {
      window.eruda && window.eruda.init()
      console.log('[base-utils] eruda ready')
    })
  }
}

function mlog(debugMode) {
  if (debugMode) {
    load(mdebugUrl, () => {
      console.log('[base-utils] mlog ready')
    })
  }
}

function init() {
  Object.keys(fireMap).forEach(key => fireMap[key](getUrlParam(key)))
}

export default {
  load: init,
  devtools,
  mlog
}
